{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (g && (g = 0, op[0] && (_ = 0)), _) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Core = void 0;\nvar Modules_1 = require(\"./Modules/Modules\");\nvar LoggerController_1 = require(\"./controllers/LoggerController\");\nvar Config_1 = require(\"./Config/Config\");\nvar CoreConfigSetup_1 = require(\"./Config/CoreConfigSetup\");\nvar version_1 = require(\"./version\");\nvar Error_1 = require(\"./Error\");\nvar dataTypes_1 = require(\"./dataTypes\");\n/**\n * Core is used in all Moralis applications\n * This class is **required** to be implemented in every app\n *\n * This class is responsible for:\n * - registering, removing and accessing modules\n * - accessing and changing the config\n */\nvar Core = /** @class */function () {\n  function Core(modules, config, logger) {\n    var _this = this;\n    this.modules = modules;\n    this.config = config;\n    this.logger = logger;\n    this.name = Core.moduleName;\n    this._isStarted = false;\n    /**\n     * Register all specified modules and configurations\n     * @params array of all modules (any module that is extended from BaseModule) that you want to include\n     */\n    this.registerModules = function (modules) {\n      modules.forEach(_this.registerModule);\n    };\n    /**\n     * Register a new module\n     */\n    this.registerModule = function (module) {\n      if ('create' in module) {\n        module = module.create(_this);\n      }\n      _this.modules.register(module);\n      _this.logger.verbose('Module registered', {\n        module: module.name\n      });\n    };\n    this.getModule = function (name) {\n      return _this.modules.get(name);\n    };\n    /**\n     * Start all modules, this function should be called before any interaction with a module,\n     * as it is responsible for initialising the modules.\n     *\n     * This will call `start()` on every registered module\n     */\n    this.start = function (providedConfig) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var allModules;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              if (this._isStarted) {\n                throw new Error_1.MoralisError({\n                  message: 'Modules are started already. This method should be called only one time.',\n                  code: Error_1.CoreErrorCode.ALREADY_INITIALIZED\n                });\n              }\n              this._isStarted = true;\n              allModules = this.modules.list();\n              if (providedConfig) {\n                this.config.merge(providedConfig);\n              }\n              this.logger.verbose('Starting all registered modules', {\n                moduleNames: this.modules.listNames()\n              });\n              return [4 /*yield*/, Promise.all(allModules.map(function (module) {\n                return module.start();\n              }))];\n            case 1:\n              _a.sent();\n              this.logger.verbose('Finished starting all registered modules', {\n                moduleNames: this.modules.listNames()\n              });\n              return [2 /*return*/];\n          }\n        });\n      });\n    };\n  }\n\n  Core.create = function () {\n    var modules = new Modules_1.Modules();\n    var config = new Config_1.Config();\n    var logger = new LoggerController_1.LoggerController(Core.moduleName, config);\n    var core = new Core(modules, config, logger);\n    CoreConfigSetup_1.CoreConfigSetup.register(config);\n    return core;\n  };\n  Object.defineProperty(Core.prototype, \"isStarted\", {\n    get: function () {\n      return this._isStarted;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Core.prototype, \"BigNumber\", {\n    get: function () {\n      return dataTypes_1.BigNumber;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Core.moduleName = 'core';\n  Core.libVersion = version_1.LIB_VERSION;\n  return Core;\n}();\nexports.Core = Core;","map":{"version":3,"mappings":"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","names":["modules","config","logger","Core","moduleName","forEach","_this","registerModule","module","create","register","verbose","name","get","providedConfig","_isStarted","Error_1","message","code","ALREADY_INITIALIZED","allModules","list","merge","moduleNames","listNames","Promise","all","map","start","_a","Modules_1","Config_1","LoggerController_1","core","CoreConfigSetup_1","Object","dataTypes_1","version_1","exports"],"sources":["../src/Core.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script","externalDependencies":[]}