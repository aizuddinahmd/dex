{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.makeVerifySignature = void 0;\nvar api_utils_1 = require(\"@moralisweb3/api-utils\");\nvar common_core_1 = require(\"@moralisweb3/common-core\");\nvar sha3_1 = require(\"../utils/sha3\");\nvar makeVerifySignature = function (core) {\n  return function (_a) {\n    var body = _a.body,\n      signature = _a.signature;\n    var apiKey = core.config.get(api_utils_1.ApiUtilsConfig.apiKey);\n    if (!apiKey) {\n      throw new common_core_1.MoralisStreamError({\n        code: common_core_1.StreamErrorCode.GENERIC_STREAM_ERROR,\n        message: 'unable to verify signature without an api key'\n      });\n    }\n    var generatedSignature = (0, sha3_1.sha3)(JSON.stringify(body) + apiKey);\n    if (signature !== generatedSignature) {\n      throw new common_core_1.MoralisStreamError({\n        code: common_core_1.StreamErrorCode.INVALID_SIGNATURE,\n        message: 'signature is not valid'\n      });\n    }\n    return true;\n  };\n};\nexports.makeVerifySignature = makeVerifySignature;","map":{"version":3,"mappings":";;;;;;AAAA;AACA;AAEA;AAOO,IAAMA,mBAAmB,GAC9B,UAACC,IAAU;EACX,iBAACC,EAA2C;QAAzCC,IAAI;MAAEC,SAAS;IAChB,IAAMC,MAAM,GAAGJ,IAAI,CAACK,MAAM,CAACC,GAAG,CAACC,0BAAc,CAACH,MAAM,CAAC;IACrD,IAAI,CAACA,MAAM,EAAE;MACX,MAAM,IAAII,gCAAkB,CAAC;QAC3BC,IAAI,EAAED,6BAAe,CAACE,oBAAoB;QAC1CC,OAAO,EAAE;OACV,CAAC;;IAEJ,IAAMC,kBAAkB,GAAG,eAAI,EAACC,IAAI,CAACC,SAAS,CAACZ,IAAI,CAAC,GAAGE,MAAM,CAAC;IAC9D,IAAID,SAAS,KAAKS,kBAAkB,EAAE;MACpC,MAAM,IAAIJ,gCAAkB,CAAC;QAC3BC,IAAI,EAAED,6BAAe,CAACO,iBAAiB;QACvCJ,OAAO,EAAE;OACV,CAAC;;IAEJ,OAAO,IAAI;EACb,CAAC;AAhBD,CAgBC;AAlBUK,2BAAmB","names":["makeVerifySignature","core","_a","body","signature","apiKey","config","get","api_utils_1","common_core_1","code","GENERIC_STREAM_ERROR","message","generatedSignature","JSON","stringify","INVALID_SIGNATURE","exports"],"sources":["../../src/methods/verifySignature.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script","externalDependencies":[]}